## ğŸ”¥**MentorQL Backend**

- ì´ ë¬¸ì„œëŠ” mentoql-backend í”„ë¡œì íŠ¸ì˜ ì½”ì–´ ë¡œì§ì¸,
  ë©˜í† ì˜ ë‹µë³€ ë°ì´í„°ë¥¼ `Milvus ë²¡í„° DB`ì— ì €ì¥í•  ë•Œ ì§ˆë¬¸/ë‹µë³€ í…ìŠ¤íŠ¸ì˜ ê¸¸ì´ ë¶ˆê· í˜•ìœ¼ë¡œ ì¸í•œ `ë²¡í„° ì™œê³¡`ì„ ë°©ì§€í•˜ê¸° ìœ„í•œ ì „ëµì„ ì„¤ëª…í•¨.

- ê·¸ë¦¬ê³  í•´ë‹¹ ì „ëµì„ ì½”ë“œë ˆë²¨ì—ì„œ ì–´ë–»ê²Œ ì ìš©í•  ê²ƒì¸ì§€ ê°„ëµí•˜ê²Œ ê¸°ìˆ í•¨.

- **Text Embedding**ì€ `@xenova/transformers`ë¥¼ ì‚¬ìš©.

- RAGì— ì‚¬ìš©ë  LLMì€ `openrouter.ai` ì œê³µë˜ëŠ” `Llama 4 Maverick`ì„ ì‚¬ìš©.

---

## âœ… ì „ì²´ í”Œë¡œìš° ìš”ì•½

1. í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ì§ˆë¬¸(question)ê³¼ ë‹µë³€(answer)ì„ ì „ë‹¬ë°›ìŒ
2. ì§ˆë¬¸ê³¼ ë‹µë³€ í…ìŠ¤íŠ¸ì˜ ê¸¸ì´ë¥¼ ë¹„êµí•˜ì—¬ ë¹„ì¤‘ ì‚°ì •
3. ì§ˆë¬¸ í…ìŠ¤íŠ¸ê°€ ë‹µë³€ë³´ë‹¤ ê¸¸ê±°ë‚˜ ë¹„ì¤‘ì´ 25% ì´ìƒì¸ ê²½ìš°:  
   â†’ **LLMì„ í†µí•´ ì§ˆë¬¸ ìš”ì•½** (25~30ì ìˆ˜ì¤€)
4. ìš”ì•½ ì´í›„ì—ë„ ë¹„ì¤‘ì´ ë§ì§€ ì•Šìœ¼ë©´:  
   â†’ **LLMì„ í†µí•´ ë‹µë³€ì„ í™•ì¥** (ìì—°ìŠ¤ëŸ½ê²Œ ì˜ë¯¸ ë³´ê°•)
5. ìµœì¢…ì ìœ¼ë¡œ ì§ˆë¬¸:ë‹µë³€ì˜ í…ìŠ¤íŠ¸ ë¹„ì¤‘ì„ 25:75 Â±2%ë¡œ ë§ì¶¤
6. ì§ˆë¬¸/ë‹µë³€ ê°ê° ì„ë² ë”© í›„, **0.25:0.75 ê°€ì¤‘ í‰ê·  ë²¡í„° ìƒì„±**
7. í•´ë‹¹ ë²¡í„°ë¥¼ Milvusì˜ `mentor_answers` ì»¬ë ‰ì…˜ì— ì €ì¥

---

## ğŸ“ ë¹„ì¤‘ ê³„ì‚° ê¸°ì¤€

```ts
const questionRatio =
  (question.length / (question.length + answer.length)) * 100;
```

- âœ… ì ì • ë²”ìœ„: `23% ~ 27%`

---

## ğŸ§  LLM ì²˜ë¦¬ ì „ëµ

### ğŸ“Œ ì§ˆë¬¸ ìš”ì•½ í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ

```
ì´ ì§ˆë¬¸ì„ 25~30ì ì´ë‚´ë¡œ ìš”ì•½í•´ì¤˜.
ìµœëŒ€í•œ í•µì‹¬ë§Œ ë‚¨ê¸°ê³  ì¤„ì—¬ì¤˜.
```

### ğŸ“Œ ë‹µë³€ í™•ì¥ í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ

```
ì•„ë˜ ë¬¸ì¥ì„ ì¢€ ë” êµ¬ì²´ì ìœ¼ë¡œ, ìì—°ìŠ¤ëŸ½ê²Œ 60ì ì´ìƒìœ¼ë¡œ í’ë¶€í•˜ê²Œ ì„¤ëª…í•´ì¤˜.
```

---

## ğŸ”¢ ë²¡í„° ê²°í•© ë°©ì‹ (ê°€ì¤‘ í‰ê· )

```ts
const combinedEmbedding = questionEmbedding.map(
  (q, i) => 0.25 * q + 0.75 * answerEmbedding[i]
);
```

- `questionEmbedding` / `answerEmbedding` ì€ ê°™ì€ ëª¨ë¸ë¡œ ìƒì„±ë˜ì–´ì•¼ í•˜ë©°, `dim`ì´ ê°™ì•„ì•¼ í•¨.
- `@xenova/transformers` ì‚¬ìš©(dim: 384)
- `metric_type`ì€ `COSINE`(ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ë°©ì‹)

---

## ğŸ’¾ Milvus ì €ì¥ êµ¬ì¡°

ì»¬ë ‰ì…˜ ì´ë¦„: `mentor_answers`

| í•„ë“œëª…      | íƒ€ì…        | ì„¤ëª…               |
| ----------- | ----------- | ------------------ |
| `id`        | Int64       | ê¸°ë³¸ í‚¤            |
| `question`  | VarChar     | ìš”ì•½ëœ ì§ˆë¬¸ í…ìŠ¤íŠ¸ |
| `answer`    | VarChar     | í™•ì¥ëœ ë‹µë³€ í…ìŠ¤íŠ¸ |
| `embedding` | FloatVector | 384ì°¨ì› ë²¡í„°       |
| `mentor_id` | VarChar     | ë©˜í†  ì‹ë³„ì        |

---

## ğŸ“ ì¶”ì²œ í•¨ìˆ˜ êµ¬ì¡° (ëª¨ë“ˆí™” ê¸°ì¤€)

- `summarizeQuestion(question: string, answer: string, recurCount: number): Promise<{q: string, a: string}>`
- `expandAnswer(text: string): Promise<string>`
- `generateBalancedEmbedding(question: string, answer: string): Promise<number[]>`
- `saveToMilvus(embedding: number[], question: string, answer: string, mentorId: string): Promise<void>`

---

## ğŸ§ª ë³´ì™„ ì‚¬í•­ ë° ì˜ˆì™¸ ì²˜ë¦¬

| ìƒí™©                       | ëŒ€ì‘ ì „ëµ                           |
| -------------------------- | ----------------------------------- |
| LLM í˜¸ì¶œ ì‹¤íŒ¨              | ì›ë¬¸ ê·¸ëŒ€ë¡œ fallback ì²˜ë¦¬           |
| ë‹µë³€ì´ ë„ˆë¬´ ì§§ì€ ê²½ìš°      | LLMìœ¼ë¡œ ìë™ í™•ì¥                   |
| ì§ˆë¬¸/ë‹µë³€ ë‘˜ ë‹¤ ì§§ì€ ê²½ìš°  | ì„ë² ë”©ë§Œ ì‹¤í–‰, ë³„ë„ ë¹„ì¤‘ ì²´í¬ ìƒëµ  |
| ë²¡í„° ê¸¸ì´ mismatch ë°œìƒ ì‹œ | ê°™ì€ ì„ë² ë”© ëª¨ë¸ë¡œ vector ìƒì„±í•  ê²ƒ |

---

## ğŸ¯ ëª©ì  ìš”ì•½

- ì§ˆë¬¸ê³¼ ë¬¸ë§¥ì´ ì˜ ë§ëŠ” ë©˜í†  ë‹µë³€ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì°¾ê¸°
- ë²¡í„° ì™œê³¡ì„ ì¤„ì´ê³  ì •ë³´ ë°€ë„ë¥¼ ìœ ì§€í•œ ìƒíƒœë¡œ ì„ë² ë”©
- Milvusì—ì„œ ì •í™•í•œ ì§ˆì˜ ê¸°ë°˜ ê²€ìƒ‰ ì„±ëŠ¥ í™•ë³´

## Out of Scope

## 1. Feedback Loop ìë™ ê°œì„  â€“ ê°„ë‹¨í•œ ì„¤ê³„ ì•„ì´ë””ì–´

### ğŸ”„ ìœ ì € ì¸í„°ë™ì…˜ ê¸°ë°˜ êµ¬ì¡°

| ì´ë²¤íŠ¸                       | ì²˜ë¦¬ ë°©ì‹                        | ì˜ˆì‹œ                               |
| ---------------------------- | -------------------------------- | ---------------------------------- |
| ë©˜í‹°ê°€ â€œë„ì›€ ëì–´ìš” ğŸ‘â€ í´ë¦­ | í•´ë‹¹ ë‹µë³€ì˜ score +1             | âœ… ìœ ì§€                            |
| â€œë„ì›€ ì•ˆ ëì–´ìš” ğŸ‘â€ í´ë¦­     | LLMì—ê²Œ ìˆ˜ì • ìš”ì²­ â†’ ìƒˆ ë²„ì „ ì €ì¥ | ğŸ”„ ê°œì„ ëœ ë‹µë³€ ëŒ€ì²´                |
| ë©˜í† ê°€ ë‹µë³€ ìˆ˜ì •             | ê¸°ì¡´ ë²¡í„° ê°±ì‹  or ìƒˆë¡œ insert    | âœ… ë©˜í†  ì‹ ë¢°ë„ í–¥ìƒ ê¸°ë°˜ í•™ìŠµ ê°€ëŠ¥ |

---

### ğŸ§  ìë™ ê°œì„  íë¦„ ì˜ˆì‹œ

plaintext

ë³µì‚¬í¸ì§‘

`ë©˜í‹°ê°€ "ë„ì›€ ì•ˆ ëì–´ìš”" í´ë¦­   â¬‡ í•´ë‹¹ ì§ˆë¬¸ + ê¸°ì¡´ ë‹µë³€ â†’ LLMì—ê²Œ ìˆ˜ì • ìš”ì²­   â¬‡ ìˆ˜ì •ëœ ë‹µë³€ì„ ê¸°ì¡´ ë‹µë³€ ë²¡í„°ë¡œ êµì²´í•˜ê±°ë‚˜ ìƒˆë¡œìš´ ë²¡í„°ë¡œ ì €ì¥   â¬‡ í–¥í›„ ë™ì¼ ì§ˆë¬¸ì— ë” ì ì ˆí•œ ì‘ë‹µ ìœ ë„`

---

### ğŸ’¬ ì†Œê°œ ë¬¸êµ¬ ì˜ˆì‹œ (ì„±ì¥í˜• ì‹œìŠ¤í…œ ê°•ì¡°)

> "ë©˜í‹°ì˜ í”¼ë“œë°±ì„ í•™ìŠµí•´ê°€ëŠ” **ì„±ì¥í˜• ë©˜í† ë§ ì‹œìŠ¤í…œ**  
> â€“ ì§ˆë¬¸ì´ ë§ì•„ì§ˆìˆ˜ë¡ ë” ë˜‘ë˜‘í•´ì§€ëŠ” ì‘ë‹µì„ ì œê³µí•©ë‹ˆë‹¤."

---

í•„ìš”í•˜ë©´ ì´í›„ì—:

- Feedback ê¸°ë¡ êµ¬ì¡° (`feedbacks` í…Œì´ë¸”/ì»¬ë ‰ì…˜ ì„¤ê³„)
- ìˆ˜ì •ëœ ë‹µë³€ì´ ê¸°ì¡´ë³´ë‹¤ ì í•©í•œì§€ íŒë‹¨í•˜ëŠ” ê¸°ì¤€
- ë©˜í†  í”¼ë“œë°±ë„ í•™ìŠµì— ë°˜ì˜í•˜ëŠ” ê³ ê¸‰ ì„¤ê³„
